<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> Eumar Rice Mill</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: 'Poppins', 'Segoe UI', sans-serif;
    background-color: #F5F7F5;
    overflow-x: hidden;
  }

  .sidebar {
    width: 250px;
    height: 100vh;
    background-color: #2E8B57;
    position: fixed;
    top: 0;
    left: 0;
    padding-top: 1rem;
    color: white;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
    box-shadow: 2px 0 10px rgba(0,0,0,0.08);
  }

  .sidebar-logo img {
    width: 150px;
    height: 150px;
    object-fit: contain;
    border-radius: 50%;
    margin: 0 auto 1rem;
    display: block;
    box-shadow: 5px rgb(246,243,243);
  }

  .sidebar h2 {
    text-align: center;
    font-weight: 700;
    letter-spacing: 1px;
    font-size: 1.3rem;
    color: #A7C957;
    margin-bottom: 1.5rem;
    user-select: none;
  }

  .nav-link {
    color: #FDFDFD;
    font-weight: 500;
    padding: 0.75rem 1.5rem;
    transition: background-color 0.3s, padding-left 0.2s;
    border-left: 4px solid transparent;
  }

  .nav-link:hover {
    background-color: #3DAE72;
    border-left: 4px solid #A7C957;
    padding-left: 1.8rem;
    text-decoration: none;
  }

  .nav-link.active {
    background-color: #276749;
    border-left: 4px solid #A7C957;
  }

  .nav-link svg {
    width: 20px;
    height: 20px;
    margin-right: 0.8rem;
    fill: white;
  }

  main {
    margin-left: 250px; 
    margin-top: 30px;       
    padding: 1rem 2rem; 
  }

  .card {
    border: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    border-radius: 12px;
  }

  .page-title {
    font-weight: 700;
    color: #333;
  }

  table th {
    background-color: #198754;
    color: white;
    font-weight: 600;
  }

  table td {
    vertical-align: middle;
  }

  .log-icon {
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background-color: rgba(25, 135, 84, 0.1);
    color: #198754;
    font-size: 1.2rem;
  }

  .search-bar {
    border-radius: 8px;
    border: 1px solid #dee2e6;
    padding: 0.5rem 1rem;
  }

  .timestamp {
    font-size: 0.9rem;
    color: #6c757d;
  }

  @media (max-width: 768px) {
    .sidebar { width: 70px; }
    .sidebar h2 { display: none; }
    .nav-link { justify-content: center; font-size: 0; }
    .nav-link svg { margin: 0; }
    .nav-link span { display: none; }
    main { margin-left: 70px; padding: 1rem; }
  }
</style>
</head>
<body>

<aside class="sidebar">
  <div class="sidebar-logo">
    <img src="/erm-logo-removebg-preview.png" alt="ERM Logo">
  </div>
  <h2>EUMAR</h2>
  <a href="/admin" class="nav-link">
    <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8v-10h-8v10zm0-18v6h8V3h-8z"/></svg>
    Dashboard
  </a>
  <a href="/admin/sales" class="nav-link">
    <svg viewBox="0 0 24 24"><path d="M4 19h16v-2H4v2zm0-6h16v-2H4v2zm0-6v2h16V7H4z"/></svg>
    Sales
  </a>
  <a href="/admin/queue" class="nav-link">
    <svg viewBox="0 0 24 24"><path d="M12 7V3L8 7h4zm0 2v7h-4l4 4 4-4h-4v-7z"/></svg>
    Queue
  </a>
    <a href="/admin/inventory" class="nav-link">
    <svg viewBox="0 0 24 24"><path d="M4 4h16v2H4V4zm0 4h16v12H4V8zm3 2v8h2v-8H7zm4 0v8h2v-8h-2zm4 0v8h2v-8h-2z"/></svg>
    Inventory
  </a>
  <a href="/user-management" class="nav-link active">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
    <span>Activity Logs</span>
  </a>
  <a href="/logout" class="nav-link mt-auto text-white">
    <svg viewBox="0 0 24 24" fill="white"><path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/></svg>
    Logout
  </a>
</aside>

<main>
 
 <div class="card p-3">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead>
          <tr>
            <th style="width: 20%">Staff</th>
            <th style="width: 20%">Action</th>
            <th>Details</th>
            <th style="width: 20%">Date&Time</th>
          </tr>
        </thead>
        <tbody>
          <% if (logs.length === 0) { %>
          <tr>
            <td colspan="4" class="text-center text-muted py-4">
              <i class="bi bi-exclamation-circle me-2"></i>No activity logs found.
            </td>
          </tr>
          <% } else { %>
          <% logs.forEach(log => { %>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <div class="log-icon me-2">
                  <i class="bi bi-person"></i>
                </div>
                <div>
                  <strong><%= log.staff_email || log.staff_username || 'Unknown' %></strong>
                </div>
              </div>
            </td>
            <td>
              <span class="badge bg-success-subtle text-success border border-success-subtle">
                <%= log.action %>
              </span>
            </td>
            <td><%= log.details %></td>
            <td class="timestamp">
              <i class="bi bi-calendar3 me-1"></i>
              <%= new Date(log.timestamp).toLocaleString() %>
            </td>
          </tr>
          <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="d-flex justify-content-between align-items-center mt-3">
  <div>
    Page <%= currentPage %> of <%= totalPages %>
  </div>

  <nav>
    <ul class="pagination mb-0">

       <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
        <a class="page-link" href="?page=<%= currentPage - 1 %>">Previous</a>
      </li>

       <li class="page-item active">
        <span class="page-link"><%= currentPage %></span>
      </li>

       <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
        <a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a>
      </li>

    </ul>
  </nav>
</div>

</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>