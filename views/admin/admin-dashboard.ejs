<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eumar Rice Mill</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      background-color: #F5F7F5;
      overflow-x: hidden;
    }

    .sidebar {
      width: 250px;
      height: 100vh;
      background-color: #2E8B57;
      position: fixed;
      top: 0;
      left: 0;
      padding-top: 1rem;
      color: white;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      box-shadow: 2px 0 10px rgba(0,0,0,0.08);
    }

    .sidebar-logo img {
      width: 150px;
      height: 150px;
      object-fit: contain;
      border-radius: 50%;
      margin: 0 auto 1rem;
      display: block;
      box-shadow: 5px rgb(246,243,243);
    }

    .sidebar h2 {
      text-align: center;
      font-weight: 700;
      letter-spacing: 1px;
      font-size: 1.3rem;
      color: #A7C957;
      margin-bottom: 1.5rem;
      user-select: none;
    }

    .nav-link {
      color: #FDFDFD;
      font-weight: 500;
      padding: 0.75rem 1.5rem;
      transition: background-color 0.3s, padding-left 0.2s;
      border-left: 4px solid transparent;
    }

    .nav-link:hover {
      background-color: #3DAE72;
      border-left: 4px solid #A7C957;
      padding-left: 1.8rem;
      text-decoration: none;
    }

    .nav-link.active {
      background-color: #276749;
      border-left: 4px solid #A7C957;
    }

    .nav-link svg {
      width: 20px;
      height: 20px;
      margin-right: 0.8rem;
      fill: white;
    }
main {
  margin-left: 250px; 
  margin-top: 0;       
  padding: 0.5rem 1rem; 
  background-color: transparent;
}


    .summary-cards .card {
      border-radius: 12px;
      box-shadow: 0 5px 10px rgba(0,0,0,0.08);
      text-align: center;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
    }

    .summary-cards .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.12);
    }
    p {
    margin-top: 0;
    margin-bottom: 1rem;
    font-size: 25px;
}
 
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }
    ::-webkit-scrollbar-thumb {
      background: #A7C957;
      border-radius: 10px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #8CB944;
    }
  </style>
</head>
<body>

  <aside class="sidebar">
    <div class="sidebar-logo">
      <img src="/erm-logo-removebg-preview.png" alt="ERM Logo">
    </div>
    <h2>EUMAR</h2>
    <a href="/admin" class="nav-link active">
      <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8v-10h-8v10zm0-18v6h8V3h-8z"/></svg>
      Dashboard
    </a>
    <a href="/admin/sales" class="nav-link">
      <svg viewBox="0 0 24 24"><path d="M4 19h16v-2H4v2zm0-6h16v-2H4v2zm0-6v2h16V7H4z"/></svg>
      Sales
    </a>
    <a href="/admin/queue" class="nav-link">
      <svg viewBox="0 0 24 24"><path d="M12 7V3L8 7h4zm0 2v7h-4l4 4 4-4h-4v-7z"/></svg>
      Queue
    </a>
    <a href="/admin/inventory" class="nav-link">
      <svg viewBox="0 0 24 24"><path d="M4 4h16v2H4V4zm0 4h16v12H4V8zm3 2v8h2v-8H7zm4 0v8h2v-8h-2zm4 0v8h2v-8h-2z"/></svg>
      Inventory
    </a>
     <a href="/user-management" class="nav-link">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
      <span>Acitivity Logs</span>
    </a>
  <a href="/logout" class="nav-link mt-auto text-white">
  <svg viewBox="0 0 24 24" fill="white">
    <path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
  </svg>
  Logout
</a>
  </aside>

  <main>
<div class="row summary-cards mb-4">
  <div class="col-md-3 mb-3">
    <div class="card p-3 text-center">
      <div class="card-body">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#2980b9" class="mb-2">
          <path d="M3 17h3V9H3v8zm5 0h3V5H8v12zm5 0h3v-4h-3v4zm5 0h3V7h-3v10z"/>
        </svg>
        <h5 class="card-title">Sales Today</h5>
        <p class="card-text">₱ <%= filteredSales.toLocaleString() %></p>
      </div>
    </div>
  </div>

  <div class="col-md-3 mb-3">
    <div class="card p-3 text-center">
      <div class="card-body">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#e67e22" class="mb-2">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10
          10-4.48 10-10S17.52 2 12 2zm1 17.93c-2.83-.48-5.08-2.73-5.56-5.56H13v-2H7.44C7.92 7.8 10.17 5.55 13 5.07V7h2V5.07c2.83.48 5.08 2.73 5.56 5.56H15v2h5.56c-.48 2.83-2.73 5.08-5.56 5.56V17h-2v2.93z"/>
        </svg>
        <h5 class="card-title">Total Sales</h5>
        <p class="card-text">₱ <%= totalSales.toLocaleString() %></p>
      </div>
    </div>
  </div>

  <div class="col-md-3 mb-3">
    <div class="card p-3 text-center">
      <div class="card-body">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#c0392b" class="mb-2">
          <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 
          1.34-3 3 1.34 3 3 3zM8 11c1.66 0 2.99-1.34 2.99-3S9.66 5 8 
          5s-3 1.34-3 3 1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 
          3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 
          0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 
          3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
        </svg>
        <h5 class="card-title">Total Queue</h5>
        <p class="card-text"><%= totalQueue %></p>
      </div>
    </div>
  </div>

  <div class="col-md-3 mb-3">
    <div class="card p-3 text-center">
      <div class="card-body">
        <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="#7f8c8d" class="mb-2">
          <path d="M20 6H4v12h16V6zm-2 10H6v-2h12v2zm0-4H6v-2h12v2zm0-4H6V6h12v2z"/>
        </svg>
        <h5 class="card-title">Inventory</h5>
        <p class="card-text"><%= totalInventory %></p>
      </div>
    </div>
  </div>
</div>

    <div class="row mb-4">
      <div class="col-md-4 mb-3">
        <div class="card p-3">
          <h6 class="text-center">Sales Distribution</h6>
          <canvas id="salesPie"></canvas>
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card p-3">
          <h6 class="text-center">Queue Status</h6>
          <canvas id="queuePie"></canvas>
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card p-3">
          <h6 class="text-center">Inventory Distribution</h6>
          <canvas id="inventoryPie"></canvas>
        </div>
      </div>
    </div>
  </main>
  <script>
  const salesData = JSON.parse('<%- JSON.stringify(pieData.sales) %>');
  const queueData = JSON.parse('<%- JSON.stringify(pieData.queue) %>');
  const inventoryData = JSON.parse('<%- JSON.stringify(pieData.inventory) %>');

  function createPieChart(ctxId, labels, data, colors) {
    new Chart(document.getElementById(ctxId), {
      type: 'pie',
      data: {
        labels: labels,
        datasets: [{
          data: data,
          backgroundColor: colors,
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed;
              }
            }
          }
        }
      }
    });
  }

   const queueColorsMap = { 
    waiting: '#e67e22',       
    serving: '#f1c40f',       
    cancelled: '#e74c3c',    
    completed: '#4CAF50'     
  };

   const queueColors = queueData.labels.map(label => {
    const key = label.toLowerCase().trim();
    return queueColorsMap[key] || '#95a5a6';  
  });

  createPieChart('salesPie', salesData.labels, salesData.data, ['#8BC34A', '#FBC02D', '#E67E22']);
  createPieChart('queuePie', queueData.labels, queueData.data, queueColors);
  createPieChart('inventoryPie', inventoryData.labels, inventoryData.data, ['#A1887F', '#C5E1A5', '#81C784']);
</script>

</body>
</html>
